---
layout: post
title:  "定义工作流驱动事件"
date:   2018-03-21
visible: 1
---

在为“事务跟踪流程”创建工作流模型之前，我们需要先定义驱动工作流的事件。大多数常见事件是由创建或更新数据库中数据实例而产生的事件（称为数据库事件）。数据库事件是数据模型的组成部分。因此，您需要使用DesignStudio工具为工作流模型定义事件。

#### 打开DesignStudio

* 从“开始”菜单 => Ebaas => DesignStudio,打开DesignStudio；
* 从DesignStudio的“文件”菜单项 => “打开” => “数据库”打开“连接数据库”弹窗；
* 从数据库列表中选择“事务跟踪管理”数据库，并以管理员用户名“admin”和密码“admin”登录;
* 在左边导航栏中选择“事务”数据类节点，然后在右下方切换到“事件”选项卡 （见下图）。

创建“IssueCreated”事件

将问题实例添加到数据库时会发生“IssueCreated”事件，该问题将启动工作流程实例。

点击“事件”标签底部的“添加”按钮，添加一个空的事件;
将其名称更改为“IssueCreated”;
选择事件类型为“插入”（见图2）;
图2：“IssueCreated”事件的定义

创建“IssueAssigned”事件

当问题实例的状态更改为“已分配”时，将发生“IssueAssigned”事件，这会将工作流实例移动到状态。

点击“事件”标签底部的“添加”按钮，添加一个空的事件;
将其名称更改为“IssueAssigned”;
选择事件类型为“更新”;
通过单击“After Condition”设置来定义此事件的条件并构建如图3所示的表达式;
图3：“IssueAssigned”事件的情况

除上述条件外，只有在更新“状态”属性的值时才需要指示事件发生（请参见图4）。
图4：指示“状态”作为更新的属性

创建“IssueRejected”事件

当问题实例的状态更改为“拒绝”时会发生“问题拒绝”事件，该问题会将工作流实例移至最终状态。

点击“添加”按钮
将事件名称更改为“IssueRejected”;
选择事件类型为“更新”;
将此事件的条件定义为“状态=拒绝”;
选择“状态”属性作为“属性更新”;
创建“IssueFixed”事件

当问题实例的状态更改为“固定”时会发生“IssueFixed”事件，这会将工作流实例移动到最终状态。

点击“添加”按钮;
将事件名称更改为“IssueFixed”;
选择事件类型为“更新”;
将此事件的条件定义为“状态=固定”;
选择“状态”属性作为“属性更新”;
