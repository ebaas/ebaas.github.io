---
layout: post
title:  "配置工作流状态"
date:   2018-03-24
visible: 1
---

在工作流中，状态“待审批”和“处理中”分别需要创建任务并赋予相应的用户。这个教程主要介绍如何在状态中配置任务相关的参数。

#### 配置“待审批”状态

“待审批”状态中的<strong>StateInitialization</strong>活动是工作流进入该状态时执行的第一个活动。因而我们要在StateInitialization活动中创建工作流任务。“待审批”状态中<strong>StateFinalization</strong>活动是工作流离开状态时执行的最后一个活动。我们将在StateFinalization注销工作流任务。具体步骤如下：

* 点击“待审批”状态中的“StateInitialization”活动，在“属性”选项卡将它的名称改为“待审批状态初始化” （改名是为了使得便于识别活动）。
* 点击“待审批”状态中的“StateFinalization”活动，在“属性”选项卡将它的名称改为“待审批状态终止化” （见下图）。

<img src="{{'/assets/img/2018-3-24-修改状态初始化和终止化.png' | prepend: site.baseurl }}" alt="">

接下来，我们要为“待审批”状态创建一个工作流任务。具体步骤如下：

鼠标双击“待审批状态初始化”活动，展开“待审批状态初始化”活动，见下图：

<img src="{{'/assets/img/2018-3-24-展开待审批状态初始化.png' | prepend: site.baseurl }}" alt="">

点击<strong>“CreateTask1”</strong>活动，将其名称更改为“创建审批任务”。<strong>“CreateTask”</strong>活动用于定义一个工作流任务。

首先配置任务的摘要和描述：

* 

用关于任务的文本设置“主题”和“任务描述”属性（参见图12）。有关任务的文本将显示在用户界面或通知电子邮件中。您可以使用{attribute name}语法将绑定数据实例的属性值包含为文本的一部分，例如{SubmitBy}或{SubmitDate}。
图12：设置任务的文本

通过单击“静态分配”下的“角色”，选择“经理”角色，然后单击“确定”（请参见图13），将任务分配给“经理”角色，这意味着具有经理角色的用户将获得任务。
图13：将任务分配给“经理”角色

您需要为此任务创建两个“已分配”和“已拒绝”操作。这些操作在任务表单底部显示为按钮。当点击“分配”按钮时，它将问题的“状态”设置为“已分配”，这会引发您先前定义的“分配已分配”事件。当单击“拒绝”按钮时，它将状态设置为“拒绝”，这会引发“问题拒绝”事件。创建“分配”动作的步骤如图14所示。
图14：创建“分配”操作

行动代码是：

this.Instance.SetValue（“状态”，“分配”）;
您可以使用相同的方式创建“拒绝”操作，但操作代码为：
this.Instance.SetValue（“状态”，“拒绝”）;
关闭“已启动”状态的任务

当工作流程离开“Started”状态时，它应该删除StartedStateInitializat中创建的任务。

